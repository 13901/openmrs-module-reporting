<?xml version="1.0" encoding="UTF-8"?>

	<!-- Beans to add to the current Web Application context definition -->

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
           http://www.springframework.org/schema/context
           http://www.springframework.org/schema/context/spring-context-2.5.xsd
           http://www.springframework.org/schema/util
           http://www.springframework.org/schema/util/spring-util-2.0.xsd">

	<bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping" />
	<context:component-scan base-package="org.openmrs.module.reporting.web" />


	<!-- Set up URL mappings for new URLs -->
    <bean id="reportingUrlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
    	<property name="order"><value>50</value></property>
    	<property name="mappings">
            <props>
				<prop key="module/reporting/indicatorWizard.form">indicatorFormController</prop>
            	<prop key="**/mappedProperty.portlet">mappedPropertyPortletController</prop>
            	<prop key="**/baseMetadata.portlet">parameterizablePortletController</prop>
            	<prop key="**/parameter.portlet">parameterPortletController</prop>
            	<prop key="**/reportDesignForm.portlet">reportDesignPortletController</prop>
            	<prop key="**/reportHistory.portlet">reportHistoryPortletController</prop>
            	<prop key="**/savedReports.portlet">savedReportsPortletController</prop>
            	<prop key="**/runReport.portlet">runReportPortletController</prop>
				<prop key="module/reporting/newIndicator.form">indicatorFormController</prop>
				<prop key="module/reporting/run/runReport.list">runReportList</prop>
				<prop key="module/reporting/run/runReport.form">runReportForm</prop>
                <prop key="module/reporting/run/reportData.form">reportDataForm</prop>
                <prop key="module/reporting/run/reportData.list">reportDataList</prop>
			</props>
		</property>
	</bean>	
	
	<bean id="indicatorFormValidator" class="org.openmrs.module.reporting.web.validator.IndicatorFormValidator"/>
	<bean id="indicatorFormController" class="org.openmrs.module.reporting.web.controller.IndicatorWizardFormController">
		<property name="validator" ref="indicatorFormValidator"/>
	</bean>
	
	<bean id="parameterizablePortletController" class="org.openmrs.module.reporting.web.controller.portlet.ParameterizablePortletController" />
	<bean id="mappedPropertyPortletController" class="org.openmrs.module.reporting.web.controller.portlet.MappedPropertyPortletController" />
	<bean id="parameterPortletController" class="org.openmrs.module.reporting.web.controller.portlet.ParameterPortletController" />
	<bean id="reportDesignPortletController" class="org.openmrs.module.reporting.web.controller.portlet.ReportDesignPortletController" />
	<bean id="reportHistoryPortletController" class="org.openmrs.module.reporting.web.controller.portlet.ReportHistoryPortletController" />
	<bean id="savedReportsPortletController" class="org.openmrs.module.reporting.web.controller.portlet.SavedReportsPortletController" />
	<bean id="runReportPortletController" class="org.openmrs.module.reporting.web.controller.portlet.RunReportPortletController" />

	<bean id="runReportList" class="org.openmrs.module.reporting.web.reports.RunReportListController">
        <property name="commandName"><value>reports</value></property>
        <property name="formView"><value>/module/reporting/run/runReportList</value></property>
        <property name="successView"><value>runReport.list</value></property>
    </bean>
	<bean id="runReportForm" class="org.openmrs.module.reporting.web.reports.RunReportFormController">
        <property name="commandName"><value>report</value></property>
        <property name="formView"><value>/module/reporting/run/runReportForm</value></property>
        <property name="successView"><value>runReport.list</value></property>
        <property name="validator">
		    <ref bean="runReportForm" />
		</property>
    </bean>
    <bean id="reportDataForm" class="org.openmrs.module.reporting.web.reports.ReportDataFormController">
        <property name="commandName"><value>reportData</value></property>
        <property name="formView"><value>/module/reporting/run/reportDataForm</value></property>
        <property name="successView"><value>reportData.form</value></property>
    </bean>
    <bean id="reportDataList" class="org.openmrs.module.reporting.web.reports.ReportDataListController">
        <property name="commandName"><value>reportData</value></property>
        <property name="formView"><value>/module/reporting/run/reportDataList</value></property>
        <property name="successView"><value>reportData.list</value></property>
    </bean>

<!--  
 	<bean id="exceptionResolver"
		class="org.springframework.web.servlet.handler.SimpleMappingExceptionResolver">
		<property name="exceptionMappings">
           <props>
                <prop key="org.openmrs.api.db.DAOException">module/reporting/common/dataAccessFailure</prop>
                <prop key="org.openmrs.api.APIException">module/reporting/common/apiFailure</prop>
                <prop key="java.lang.Exception">module/reporting/common/generalFailure</prop>
         	</props>
        </property>				
		<property name="defaultErrorView" value="generalFailure" />
	</bean>
-->

</beans>
